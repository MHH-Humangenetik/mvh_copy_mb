{% if pair.genomic and pair.clinical %}
<!-- Complete pair: genomic row -->
<tr class="pair-row genomic priority-group-{{ pair.priority_group }}"
    data-case-id="{{ pair.case_id }}"
    id="pair-genomic-{{ pair.case_id }}">
    <td class="case-id-cell" rowspan="2">{{ pair.case_id }}</td>
    <td>
        <span>{{ pair.genomic.vorgangsnummer }}</span>
        <span class="copy-btn" onclick="copyToClipboard('{{ pair.genomic.vorgangsnummer }}')" title="Copy to clipboard">ðŸ“‹</span>
    </td>
    <td>
        <span class="ibe-string">{{ pair.genomic.meldebestaetigung }}</span>
        <span class="copy-btn" onclick="copyToClipboard('{{ pair.genomic.meldebestaetigung }}')" title="Copy to clipboard">ðŸ“‹</span>
    </td>
    <td>genomic</td>
    <td>{{ pair.genomic.typ_der_meldung }}</td>
    <td>{{ pair.genomic.indikationsbereich }}</td>
    <td>{{ pair.genomic.ergebnis_qc }}</td>
    <td>{{ pair.genomic.source_file }}</td>
    <td class="output-date-cell">{{ pair.genomic.output_date.strftime('%Y-%m-%d') if pair.genomic.output_date else '' }}</td>
    <td>
        <span class="complete-indicator {{ 'yes' if pair.is_complete else 'no' }}"></span>
    </td>
    <td>
        <span class="valid-indicator {{ 'yes' if pair.is_valid else 'no' }}"></span>
    </td>
    <td class="done-cell" rowspan="2">
        <input 
            type="checkbox" 
            {{ 'checked' if pair.is_done else '' }}
            hx-post="/api/done/{{ pair.case_id }}"
            hx-vals='{"done": {{ "false" if pair.is_done else "true" }}}'
            hx-target="#pair-genomic-{{ pair.case_id }}"
            hx-swap="outerHTML"
            hx-indicator="#loading">
    </td>
</tr>
<!-- Complete pair: clinical row -->
<tr class="pair-row clinical priority-group-{{ pair.priority_group }}"
    data-case-id="{{ pair.case_id }}"
    id="pair-clinical-{{ pair.case_id }}"
    hx-swap-oob="outerHTML:#pair-clinical-{{ pair.case_id }}">
    <td>
        <span>{{ pair.clinical.vorgangsnummer }}</span>
        <span class="copy-btn" onclick="copyToClipboard('{{ pair.clinical.vorgangsnummer }}')" title="Copy to clipboard">ðŸ“‹</span>
    </td>
    <td>
        <span class="ibe-string">{{ pair.clinical.meldebestaetigung }}</span>
        <span class="copy-btn" onclick="copyToClipboard('{{ pair.clinical.meldebestaetigung }}')" title="Copy to clipboard">ðŸ“‹</span>
    </td>
    <td>clinical</td>
    <td>{{ pair.clinical.typ_der_meldung }}</td>
    <td>{{ pair.clinical.indikationsbereich }}</td>
    <td>{{ pair.clinical.ergebnis_qc }}</td>
    <td>{{ pair.clinical.source_file }}</td>
    <td class="output-date-cell">{{ pair.clinical.output_date.strftime('%Y-%m-%d') if pair.clinical.output_date else '' }}</td>
    <td>
        <span class="complete-indicator {{ 'yes' if pair.is_complete else 'no' }}"></span>
    </td>
    <td>
        <span class="valid-indicator {{ 'yes' if pair.is_valid else 'no' }}"></span>
    </td>
</tr>
{% elif pair.genomic %}
<!-- Genomic only pair -->
<tr class="pair-row genomic priority-group-{{ pair.priority_group }}"
    data-case-id="{{ pair.case_id }}">
    <td class="case-id-cell">{{ pair.case_id }}</td>
    <td>
        <span>{{ pair.genomic.vorgangsnummer }}</span>
        <span class="copy-btn" onclick="copyToClipboard('{{ pair.genomic.vorgangsnummer }}')" title="Copy to clipboard">ðŸ“‹</span>
    </td>
    <td>
        <span class="ibe-string">{{ pair.genomic.meldebestaetigung }}</span>
        <span class="copy-btn" onclick="copyToClipboard('{{ pair.genomic.meldebestaetigung }}')" title="Copy to clipboard">ðŸ“‹</span>
    </td>
    <td>genomic</td>
    <td>{{ pair.genomic.typ_der_meldung }}</td>
    <td>{{ pair.genomic.indikationsbereich }}</td>
    <td>{{ pair.genomic.ergebnis_qc }}</td>
    <td>{{ pair.genomic.source_file }}</td>
    <td class="output-date-cell">{{ pair.genomic.output_date.strftime('%Y-%m-%d') if pair.genomic.output_date else '' }}</td>
    <td>
        <span class="complete-indicator {{ 'yes' if pair.is_complete else 'no' }}"></span>
    </td>
    <td>
        <span class="valid-indicator {{ 'yes' if pair.is_valid else 'no' }}"></span>
    </td>
    <td class="done-cell">
        <span>â€”</span>
    </td>
</tr>
{% elif pair.clinical %}
<!-- Clinical only pair -->
<tr class="pair-row clinical priority-group-{{ pair.priority_group }}"
    data-case-id="{{ pair.case_id }}">
    <td class="case-id-cell">{{ pair.case_id }}</td>
    <td>
        <span>{{ pair.clinical.vorgangsnummer }}</span>
        <span class="copy-btn" onclick="copyToClipboard('{{ pair.clinical.vorgangsnummer }}')" title="Copy to clipboard">ðŸ“‹</span>
    </td>
    <td>
        <span class="ibe-string">{{ pair.clinical.meldebestaetigung }}</span>
        <span class="copy-btn" onclick="copyToClipboard('{{ pair.clinical.meldebestaetigung }}')" title="Copy to clipboard">ðŸ“‹</span>
    </td>
    <td>clinical</td>
    <td>{{ pair.clinical.typ_der_meldung }}</td>
    <td>{{ pair.clinical.indikationsbereich }}</td>
    <td>{{ pair.clinical.ergebnis_qc }}</td>
    <td>{{ pair.clinical.source_file }}</td>
    <td class="output-date-cell">{{ pair.clinical.output_date.strftime('%Y-%m-%d') if pair.clinical.output_date else '' }}</td>
    <td>
        <span class="complete-indicator {{ 'yes' if pair.is_complete else 'no' }}"></span>
    </td>
    <td>
        <span class="valid-indicator {{ 'yes' if pair.is_valid else 'no' }}"></span>
    </td>
    <td class="done-cell">
        <span>â€”</span>
    </td>
</tr>
{% endif %}
